geom_violin(alpha=0.5, color="gray")+
labs(x="Comparacion departamento de emisor y receptor",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=0, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_identity())
ggplot(T3,aes(x=Departamento_similar,y=n,fill=Comportamiento))+
geom_bar(stat = "identity")+
geom_violin(alpha=0.5, color="gray")+
labs(x="Comparacion departamento de emisor y receptor",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=0, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_dodge())
ggplot(T3,aes(x=Departamento_similar,y=n,fill=Comportamiento))+
geom_bar(stat = "identity")+
geom_violin(alpha=0.5, color="gray")+
labs(x="Comparacion departamento de emisor y receptor",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=0, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_())
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = 1
ggplot(T3,aes(x=Departamento_similar,y=n,fill=Comportamiento))+
geom_bar(stat = "identity")+
geom_violin(alpha=0.5, color="gray")+
labs(x="Comparacion departamento de emisor y receptor",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=0, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = 1)
ggplot(T3,aes(x=Departamento_similar,y=n,fill=Comportamiento))+
geom_bar(stat = "identity")+
geom_violin(alpha=0.5, color="gray")+
labs(x="Comparacion departamento de emisor y receptor",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=0, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_dodge())
ggplot(T3,aes(x=Departamento_similar,y=n,fill=Comportamiento))+
geom_bar(stat = "identity")+
geom_violin(alpha=0.5, color="gray")+
labs(x="Comparacion departamento de emisor y receptor",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=0, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_dodge(5))
ggplot(T3,aes(x=Departamento_similar,y=n,fill=Comportamiento))+
geom_bar(stat = "identity")+
geom_violin(alpha=0.5, color="gray")+
labs(x="Comparacion departamento de emisor y receptor",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=0, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_dodge(1))
ggplot(T3,aes(x=Departamento_similar,y=n,fill=Comportamiento))+
geom_col(stat = "identity")+
geom_violin(alpha=0.5, color="gray")+
labs(x="Comparacion departamento de emisor y receptor",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=0, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_dodge())
ggplot(T3,aes(x=Departamento_similar,y=n,fill=Comportamiento))+
geom_col(stat = "identity")+
geom_violin(alpha=0.5, color="gray")+
labs(x="Comparacion departamento de emisor y receptor",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=0, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = "dodge")
ggplot(T3,aes(x=Departamento_similar,y=n,fill=Comportamiento))+
geom_bar(stat = "identity")+
geom_violin(alpha=0.5, color="gray")+
labs(x="Comparacion departamento de emisor y receptor",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=0, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
View(T3)
ggplot(T3,aes(x=Departamento_similar,y=n,fill=Comportamiento))+
geom_bar(stat = "identity")+
labs(x="Comparacion departamento de emisor y receptor",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=0, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
#Gráfico 3: Diferente departamento
###########################################################################
T3 <- MD_Factura %>%
group_by(Departamento_similar,Comportamiento) %>%
summarise(PVenta=sum(MTO_IMPCPE),n=n()) %>%
mutate(porc=round(100*n/sum(n),1)) %>%
mutate(sa=cumsum(porc))
ggplot(T3,aes(x=Departamento_similar,y=n,fill=Comportamiento))+
geom_bar(stat = "identity")+
labs(x="Comparacion departamento de emisor y receptor",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=0, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
MD_Factura %>%
group_by(Departamento_similar,Comportamiento) %>%
summarise(PVenta=sum(MTO_IMPCPE),n=n())
MD_Factura %>%
group_by(Departamento_similar,Comportamiento) %>%
summarise(PVenta=sum(MTO_IMPCPE),n=n()) %>%
mutate(porc=round(100*n/sum(n),1)) %>%
MD_Factura %>%
group_by(Departamento_similar,Comportamiento) %>%
summarise(PVenta=sum(MTO_IMPCPE),n=n()) %>%
mutate(porc=round(100*n/sum(n),1))
#Gráfico 3: Diferente departamento
###########################################################################
T3 <- MD_Factura %>%
group_by(Departamento_similar,Comportamiento) %>%
summarise(PVenta=sum(MTO_IMPCPE),n=n())
T3%>%
mutate(porc=round(100*n/sum(n),1)) %>%
mutate(sa=cumsum(porc))
T3%>%
mutate(porc=round(100*n/sum(n),1))
T3%>%
mutate(porc=round(sum(n),1))
#Gráfico 3: Diferente departamento
###########################################################################
T3 <- as.data.frame(MD_Factura %>%
group_by(Departamento_similar,Comportamiento) %>%
summarise(PVenta=sum(MTO_IMPCPE),n=n()) )
T3%>%
mutate(porc=round(100*n/sum(n),1))
T3 <- T3%>%
mutate(porc=round(100*n/sum(n),1)) %>%
mutate(sa=cumsum(porc))
ggplot(T3,aes(x=Departamento_similar,y=n,fill=Comportamiento))+
geom_bar(stat = "identity")+
labs(x="Comparacion departamento de emisor y receptor",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=0, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
ggplot(T3,aes(x=Departamento_similar,y=PVenta,fill=Comportamiento))+
geom_bar(stat = "identity")+
labs(x="Comparacion departamento de emisor y receptor",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=0, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
ggplot(T3,aes(x=Departamento_similar,y=PVenta,fill=Comportamiento))+
geom_bar(stat = "identity")+
labs(x="Comparacion departamento de emisor y receptor",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=0, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"% - ",n,sep="")),size =3,position = position_stack(vjust = 0.5))
ggplot(T3,aes(x=Departamento_similar,y=PVenta,fill=Comportamiento))+
geom_bar(stat = "identity")+
labs(x="Comparacion departamento de emisor y receptor",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=0, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
ggplot(T3,aes(x=Departamento_similar,y=PVenta,fill=Comportamiento))+
geom_bar(stat = "identity")+
labs(x="Comparacion departamento de emisor y receptor",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000000,"M"))})+
theme(axis.text.x=element_text(angle=0, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
ggplot(T3,aes(x=Departamento_similar,y=n,fill=Comportamiento))+
geom_bar(stat = "identity")+
labs(x="Comparacion departamento de emisor y receptor",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=0, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
#Gráfico 4: Diferente departamento
###########################################################################
T4 <- as.data.frame(MD_Factura %>%
group_by(ruc_segmentos.nom_segfisca,Comportamiento) %>%
summarise(PVenta=sum(MTO_IMPCPE),n=n()) )
T4 <- T4%>%
mutate(porc=round(100*n/sum(n),1)) %>%
mutate(sa=cumsum(porc))
ggplot(T4,aes(x=ruc_segmentos.nom_segfisca,y=n,fill=Comportamiento))+
geom_bar(stat = "identity")+
labs(x="Comparacion departamento de emisor y receptor",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=0, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
ggplot(T4,aes(x=ruc_segmentos.nom_segfisca,y=n,fill=Comportamiento))+
geom_bar(stat = "identity")+
labs(x="Comparacion departamento de emisor y receptor",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=90, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
#Gráfico 4: Diferente departamento
###########################################################################
excluir <- c("ENTIDAD DEL ESTADO","PERSONA NATURAL SIN EMPRESA","POR CLASIFICAR","SIN ACTIVIDAD","ENTIDAD SIN FINES DE LUCRO"
#Gráfico 4: Diferente departamento
###########################################################################
excluir <- c("ENTIDAD DEL ESTADO","PERSONA NATURAL SIN EMPRESA","POR CLASIFICAR","SIN ACTIVIDAD","ENTIDAD SIN FINES DE LUCRO")
T4 <- as.data.frame(MD_Factura %>% filter(ruc_segmentos.nom_segfisca %not%in% excluir)
group_by(ruc_segmentos.nom_segfisca,Comportamiento) %>%
summarise(PVenta=sum(MTO_IMPCPE),n=n()) )
T4 <- as.data.frame(MD_Factura %>% filter(ruc_segmentos.nom_segfisca !%in% excluir)
group_by(ruc_segmentos.nom_segfisca,Comportamiento) %>%
summarise(PVenta=sum(MTO_IMPCPE),n=n()) )
#Gráfico 4: Diferente departamento
###########################################################################
"%w/o%" <- function(x, y) x[!x %in% y]
T4 <- as.data.frame(MD_Factura %>% filter(ruc_segmentos.nom_segfisca %w/o% excluir)
group_by(ruc_segmentos.nom_segfisca,Comportamiento) %>%
summarise(PVenta=sum(MTO_IMPCPE),n=n()) )
excluir <- c("ENTIDAD DEL ESTADO","PERSONA NATURAL SIN EMPRESA","POR CLASIFICAR","SIN ACTIVIDAD","ENTIDAD SIN FINES DE LUCRO")
T4 <- as.data.frame(MD_Factura %>% filter(ruc_segmentos.nom_segfisca %w/o% excluir)
group_by(ruc_segmentos.nom_segfisca,Comportamiento) %>%
summarise(PVenta=sum(MTO_IMPCPE),n=n()) )
T4 <- as.data.frame(MD_Factura %>% filter(ruc_segmentos.nom_segfisca %w/o% excluir) %>%
group_by(ruc_segmentos.nom_segfisca,Comportamiento) %>%
summarise(PVenta=sum(MTO_IMPCPE),n=n()) )
(1:10) %w/o% c(3,7,12)
T4 <- T4%>%
mutate(porc=round(100*n/sum(n),1)) %>%
mutate(sa=cumsum(porc))
ggplot(T4,aes(x=ruc_segmentos.nom_segfisca %w/o% excluir,y=n,fill=Comportamiento))+
geom_bar(stat = "identity")+
labs(x="Comparacion departamento de emisor y receptor",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=90, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
ggplot(T4,aes(x=ruc_segmentos.nom_segfisca,y=n,fill=Comportamiento))+
geom_bar(stat = "identity")+
labs(x="Comparacion departamento de emisor y receptor",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=90, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
T4 <- as.data.frame(MD_Factura %>% filter(ruc_segmentos.nom_segfisca %in% excluir) %>%
group_by(ruc_segmentos.nom_segfisca,Comportamiento) %>%
summarise(PVenta=sum(MTO_IMPCPE),n=n()) )
T4 <- as.data.frame(MD_Factura %>%
group_by(ruc_segmentos.nom_segfisca,Comportamiento) %>%
summarise(PVenta=sum(MTO_IMPCPE),n=n()) )
View(T4)
incluir <- c("GRAN MEDIANO","GRANDE","MEDIANO","MEGA","MICRO","PEQUEÃ‘O","TOP")
T4 <- as.data.frame(MD_Factura %>% filter(ruc_segmentos.nom_segfisca %in% incluir) %>%
group_by(ruc_segmentos.nom_segfisca,Comportamiento) %>%
summarise(PVenta=sum(MTO_IMPCPE),n=n()) )
T4 <- T4%>%
mutate(porc=round(100*n/sum(n),1)) %>%
mutate(sa=cumsum(porc))
ggplot(T4,aes(x=ruc_segmentos.nom_segfisca,y=n,fill=Comportamiento))+
geom_bar(stat = "identity")+
labs(x="Comparacion departamento de emisor y receptor",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=90, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
ggplot(T4,aes(x=order(ruc_segmentos.nom_segfisca,n),y=n,fill=Comportamiento))+
geom_bar(stat = "identity")+
labs(x="Comparacion departamento de emisor y receptor",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=90, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
ggplot(T4,aes(x=order(n,ruc_segmentos.nom_segfisca),y=n,fill=Comportamiento))+
geom_bar(stat = "identity")+
labs(x="Comparacion departamento de emisor y receptor",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=90, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
ggplot(T4,aes(x=reorder(ruc_segmentos.nom_segfisca,n),y=n,fill=Comportamiento))+
geom_bar(stat = "identity")+
labs(x="Comparacion departamento de emisor y receptor",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=90, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
ggplot(T4,aes(x=reorder(ruc_segmentos.nom_segfisca,-n),y=n,fill=Comportamiento))+
geom_bar(stat = "identity")+
labs(x="Comparacion departamento de emisor y receptor",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=90, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
ggplot(T4,aes(x=reorder(ruc_segmentos.nom_segfisca,-n),y=n,fill=Comportamiento))+
geom_bar(stat = "identity")+
labs(x="Segmento del emisor de CPE Factura",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=90, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
T5 <- as.data.frame(MD_Factura %>%
group_by(dia_semana,Comportamiento) %>%
summarise(PVenta=sum(MTO_IMPCPE),n=n()) )
T5 <- T5%>%
mutate(porc=round(100*n/sum(n),1)) %>%
mutate(sa=cumsum(porc))
ggplot(T5,aes(x=reorder(dia_semana,-n),y=n,fill=Comportamiento))+
geom_bar(stat = "identity")+
labs(x="Segmento del emisor de CPE Factura",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=90, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
ggplot(T5,aes(x=dia_semana,y=n,fill=Comportamiento))+
geom_bar(stat = "identity")+
labs(x="Segmento del emisor de CPE Factura",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=90, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
ggplot(T5,aes(x=dia_semana,y=n))+
geom_bar(stat = "identity")+
labs(x="Segmento del emisor de CPE Factura",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=90, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
ggplot(T5,aes(x=dia_semana,y=n))+
geom_bar(stat = "identity")+
labs(x="Día de semana de emisión de CPE Factura",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=90, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
#Gráfico 6:
###########################################################################
T6 <- as.data.frame(MD_Factura %>%
group_by(comercio_ext,Comportamiento) %>%
summarise(PVenta=sum(MTO_IMPCPE),n=n()) )
T6 <- T6%>%
mutate(porc=round(100*n/sum(n),1)) %>%
mutate(sa=cumsum(porc))
ggplot(T6,aes(x=comercio_ext,y=n))+
geom_bar(stat = "identity")+
labs(x="Día de semana de emisión de CPE Factura",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=90, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
ggplot(T6,aes(x=comercio_ext,y=n,fill=Comportamiento))+
geom_bar(stat = "identity")+
labs(x="Día de semana de emisión de CPE Factura",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=90, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
#Gráfico 6:
###########################################################################
T6 <- as.data.frame(MD_Factura %>%
group_by(comercio_ext) %>%
summarise(PVenta=sum(MTO_IMPCPE),n=n()) )
T6 <- T6%>%
mutate(porc=round(100*n/sum(n),1)) %>%
mutate(sa=cumsum(porc))
ggplot(T6,aes(x=comercio_ext,y=n))+
geom_bar(stat = "identity")+
labs(x="Día de semana de emisión de CPE Factura",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=90, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
ggplot(T6,aes(x=reorder(comercio_ext,-n),y=n))+
geom_bar(stat = "identity")+
labs(x="Día de semana de emisión de CPE Factura",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=90, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
ggplot(T6,aes(x=reorder(comercio_ext,-n),y=n))+
geom_bar(stat = "identity")+
labs(x="Estado de comercio exterior",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=90, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
ggplot(T6,aes(x=reorder(comercio_ext,-n),y=n))+
geom_bar(stat = "identity")+
labs(x="Estado de comercio exterior",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=90, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
ggplot(T6,aes(x=reorder(comercio_ext,-n),y=n))+
geom_bar(stat = "identity")+
labs(x="Comercio exterior",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=90, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
ggplot(T6,aes(x=reorder(comercio_ext,-n),y=n))+
geom_bar(stat = "identity")+
labs(x="Comercio exterior",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=45, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
ggplot(T6,aes(x=reorder(comercio_ext,-n),y=n))+
geom_bar(stat = "identity")+
labs(x="Comercio exterior",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=90, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
#Gráfico 7:
###########################################################################
T7 <- as.data.frame(MD_Factura %>%
group_by(facturacion) %>%
summarise(PVenta=sum(MTO_IMPCPE),n=n()) )
T7 <- T7%>%
mutate(porc=round(100*n/sum(n),1)) %>%
mutate(sa=cumsum(porc))
ggplot(T7,aes(x=reorder(facturacion,-n),y=n))+
geom_bar(stat = "identity")+
labs(x="Comercio exterior",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=90, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
save.image("D:/Retos/01.Gastos no deducibles/10.Consolidado/Wspace_Consolidado_V8.RData")
library(tidyverse)
library(data.table)
library(stringi)
library(dummies)
library(randomForest)
library(caret)
library(nnet)
library(devtools)
library(rpart)
library(e1071)
library(ROCR)
memory.limit(size = 10000) #Aumentar memoria RAM
load("D:/Retos/01.Gastos no deducibles/10.Consolidado/Wspace_Consolidado_V8.RData")
ggplot(T4,aes(x=reorder(ruc_segmentos.nom_segfisca,-n),y=n,fill=Comportamiento))+
geom_bar(stat = "identity")+
labs(x="Segmento del emisor de CPE Factura",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=90, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
#Gráfico 4: Diferente departamento
###########################################################################
library(tidyverse)
ggplot(T4,aes(x=reorder(ruc_segmentos.nom_segfisca,-n),y=n,fill=Comportamiento))+
geom_bar(stat = "identity")+
labs(x="Segmento del emisor de CPE Factura",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=90, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
ggplot(T4,aes(x=reorder(ruc_segmentos.nom_segfisca,-n),y=n,fill=Comportamiento))+
geom_bar(stat = "identity")+
labs(x="Segmento del emisor de CPE Factura",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=90, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_text( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
ggplot(T3,aes(x=Departamento_similar,y=n,fill=Comportamiento))+
geom_bar(stat = "identity")+
labs(x="Comparacion departamento de emisor y receptor",y="N° Factura")+
scale_y_continuous(label=function(x){return(paste(x/1000,"k"))})+
theme(axis.text.x=element_text(angle=0, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))+
geom_label( aes(label = paste(porc,"%",sep="")),size =3,position = position_stack(vjust = 0.5))
ggplot(T2,aes(x=cut3_Monto,y=n,fill=Comportamiento))+
geom_bar(stat = "identity")+
geom_violin(alpha=0.5, color="gray")+
labs(title='Precio Venta de CPE Factura emitidas',x="Días de semana",y="Precio de venta (S/.)")+
scale_y_continuous(label=function(x){return(paste(x/1000000,"M"))})+
theme(axis.text.x=element_text(angle=90, size=8, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5))
ggplot(data = T1, aes(x = cut3_Monto, y=n))+
geom_bar(stat = "identity")+
labs(title='CPE Facturas emitidas',x="Categoría de Precio de venta (S/.)",y="N°Facturas")+
scale_y_continuous(label=function(x){return(paste(x/1000, "k"))})+
theme(axis.text.x=element_text(angle=90, size=9, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5)) +
geom_label( aes(label = paste(porc,"%",sep=""),
y = n + 4), position = position_dodge(1),  vjust = 0.5,size =3,angle=90)+
annotate("text", label = "83% de las facturas registran precios de venta menor a S/400", x =7,y=350000, size = 4, colour = "blue")
ggplot(data = T1, aes(x = cut3_Monto, y=n))+
geom_bar(stat = "identity")+
labs(title='CPE Facturas emitidas',x="Categoría de Precio de venta (S/.)",y="N°Facturas")+
scale_y_continuous(label=function(x){return(paste(x/1000, "k"))})+
theme(axis.text.x=element_text(angle=90, size=9, vjust=0.5),
plot.title =element_text(size=12, face="bold", vjust=0.5,hjust=0.5)) +
geom_text( aes(label = paste(porc,"%",sep=""),
y = n + 4), position = position_dodge(1),  vjust = 0.5,size =3,angle=90)+
annotate("text", label = "83% de las facturas registran precios de venta menor a S/400", x =7,y=350000, size = 4, colour = "blue")
Frecuencia_IGV <- fread("01.BD/6INDICADORES/PDT_FrecIGV.csv",colClasses = list(character=1:2))
library(data.table)
Frecuencia_IGV <- fread("01.BD/6INDICADORES/PDT_FrecIGV.csv",colClasses = list(character=1:2))
View(Frecuencia_IGV)
Frecuencia_IGV <- fread("01.BD/6INDICADORES/PDT_FrecIGV.csv",colClasses = list(character=1:2),nrow=10)
View(Frecuencia_IGV)
Frecuencia_IGV <- fread("01.BD/6INDICADORES/PDT_FrecIGV.csv",colClasses = list(character=1:2)
)
View(Frecuencia_IGV)
Frecuencia_IGV_0_10 <- fread("01.BD/6INDICADORES/PDT_FrecIGV.csv",colClasses = list(character=1:2),nrow=10)
View(Frecuencia_IGV_0_10)
Frecuencia_IGV_11 <- fread("01.BD/6INDICADORES/PDT_FrecIGV.csv",colClasses = list(character=1:2),nrow=10,skip = 11)
View(Frecuencia_IGV_11)
Frecuencia_IGV_0_10 <- fread("01.BD/6INDICADORES/PDT_FrecIGV.csv",colClasses = list(character=1:2),nrow=6)
View(Frecuencia_IGV_0_10)
Frecuencia_IGV_11 <- fread("01.BD/6INDICADORES/PDT_FrecIGV.csv",colClasses = list(character=1:2),skip = 7)
install.packages("rticles")
